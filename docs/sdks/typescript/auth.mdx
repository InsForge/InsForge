---
title: Authentication SDK Reference
description: User authentication and profile management with the InsForge TypeScript SDK
---

## Installation

import Installation from '/snippets/sdk-installation.mdx';

<Installation />

## signUp()

Create a new user account with email and password.

### Parameters

- `email` (string, required) - User's email address
- `password` (string, required) - User's password
- `name` (string, optional) - User's display name
- `options` (object, optional) - Additional options
  - `emailRedirectTo` (string, optional) - Custom URL to redirect to after email verification. It's a fallback if you didn't set default redirect URL configured in your dashboard.

### Returns

```typescript
{
  data: {
    user: { id, email, emailVerified, providers, createdAt, updatedAt, profile, metadata },
    accessToken: string,
    requireEmailVerification: boolean,
    csrfToken: string
  } | null,
  error: Error | null
}
```

### Example

```typescript
const { data, error } = await insforge.auth.signUp({
  email: 'user@example.com',
  password: 'secure_password123',
  name: 'John Doe',
});
```

### Output

```json
{
  "data": {
    "user": {
      "id": "usr_abc123",
      "email": "user@example.com",
      "emailVerified": true,
      "providers": ["google"],
      "createdAt": "2024-01-15T10:00:00Z",
      "updatedAt": "2024-01-15T10:00:00Z",
      "profile": {
        "name": "John Doe",
        "avatar_url": "https://example.com/jane.jpg"
      },
      "metadata": {}
    },
    "requireEmailVerification": true,
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "csrfToken": "5758d38259fb..."
  },
  "error": null
}
```

---

## signInWithPassword()

Sign in an existing user with email and password.

### Parameters

- `email` (string, required) - User's email address
- `password` (string, required) - User's password

### Returns

```typescript
{
  data: {
    user: { id, email, emailVerified, providers, createdAt, updatedAt, profile, metadata },
    accessToken: string,
    csrfToken: string
  } | null,
  error: Error | null
}
```

### Example

```typescript
const { data, error } = await insforge.auth.signInWithPassword({
  email: 'user@example.com',
  password: 'secure_password123',
});
```

### Output

```json
{
  "data": {
    "user": {
      "id": "usr_abc123",
      "email": "user@example.com",
      "emailVerified": true,
      "providers": ["google"],
      "createdAt": "2024-01-15T10:00:00Z",
      "updatedAt": "2024-01-15T10:00:00Z",
      "profile": {
        "name": "John Doe",
        "avatar_url": "https://example.com/avatar.jpg"
      },
      "metadata": {}
    },
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "csrfToken": "5758d38259fb..."
  },
  "error": null
}
```

---

## signInWithOAuth()

Start OAuth authentication flow with supported providers (Google, GitHub, Microsoft, Discord, and more).

### Parameters

- `provider` (string, required) - OAuth provider name (e.g., 'google', 'github', 'microsoft', 'discord')
- `redirectTo` (string, optional) - URL to redirect after authentication
- `skipBrowserRedirect` (boolean, optional) - If true, returns OAuth URL without auto-redirecting (for mobile apps)

### Returns

```typescript
{
  data: { url?: string, provider?: string },
  error: Error | null
}
```

<Note>
  After OAuth redirect, SDK automatically detects callback parameters and saves session. No manual
  handling needed.
</Note>

### Example

```typescript
// Default: auto-redirect
await insforge.auth.signInWithOAuth({
  provider: 'google',
  redirectTo: 'http://localhost:3000/dashboard',
});
// Browser immediately redirects to Google

// skipBrowserRedirect: get URL for manual handling
const { data } = await insforge.auth.signInWithOAuth({
  provider: 'google',
  skipBrowserRedirect: true,
});

window.location.href = data.url; // Redirect when ready
```

### Output

```json
{
  "data": {
    "url": "https://accounts.google.com/o/oauth2/v2/auth?client_id=...",
    "provider": "google"
  },
  "error": null
}
```

---

## signOut()

Sign out the current user and clear session.

### Parameters

None

### Returns

```typescript
{
  error: Error | null;
}
```

### Example

```typescript
const { error } = await insforge.auth.signOut();
```

### Output

```json
{
  "error": null
}
```

---

## getCurrentUser()

Get authenticated user with profile data from users table.

### Parameters

None

### Returns

```typescript
{
  data: {
    user: { id, email, emailVerified, providers, profile, metadata, createdAt, updatedAt }
  } | null,
  error: Error | null
}
```

### Example

```typescript
const { data, error } = await insforge.auth.getCurrentUser();

if (data) {
  console.log(data.user.email); // Auth info
  console.log(data.user.profile.name); // Profile from users table
}
```

### Output

```json
{
  "data": {
    "user": {
      "id": "usr_abc123",
      "email": "user@example.com",
      "emailVerified": true,
      "providers": ["google"],
      "createdAt": "2024-01-15T10:00:00Z",
      "updatedAt": "2024-01-15T10:00:00Z",
      "profile": {
        "name": "John Doe",
        "avatar_url": "https://example.com/avatar.jpg"
      },
      "metadata": {}
    }
  },
  "error": null
}
```

---

## getCurrentSession()

Get current session from local storage (no API call).

### Parameters

None

### Returns

```typescript
{
  data: {
    session: {
      accessToken: string,
      user: { id, email, profile, ... }
    } | null
  },
  error: Error | null
}
```

### Example

```typescript
const { data, error } = await insforge.auth.getCurrentSession();

if (data.session) {
  console.log('Token:', data.session.accessToken);
}
```

### Output

```json
{
  "data": {
    "session": {
      "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "user": {
        "id": "usr_abc123",
        "email": "user@example.com",
        "emailVerified": true,
        "createdAt": "2025-12-22T19:13:08.586Z",
        "updatedAt": "2025-12-22T19:13:08.586Z",
        "providers": ["google"],
        "profile": {
          "name": "John Doe",
          "avatar_url": "https://example.com/avatar.jpg"
        },
        "metadata": {}
      }
    }
  },
  "error": null
}
```

---

## getProfile()

Get any user's public profile by ID.

### Parameters

- `userId` (string, required) - User ID to fetch profile for

### Returns

```typescript
{
  data: { id, profile: { name, avatar_url, ... } } | null,
  error: Error | null
}
```

### Example

```typescript
const { data, error } = await insforge.auth.getProfile('usr_xyz789');

console.log(data.profile.name);
```

### Output

```json
{
  "data": {
    "id": "usr_xyz789",
    "profile": {
      "name": "John Doe",
      "avatar_url": "https://example.com/jane.jpg"
    }
  },
  "error": null
}
```

---

## setProfile()

Update current user's profile in users table (supports any dynamic fields).

### Parameters

- `profile` (object) - A key-value map of profile fields to update. Any fields are accepted.

**Common fields:**

- `name` (predefined, string) - User's display name
- `avatar_url` (predefined, string) - Profile picture URL
- `bio` (custom, string) - User biography
- `birthday` (custom, string) - Birth date (YYYY-MM-DD format)

### Returns

```typescript
{
  data: { id, ...profile_fields } | null,
  error: Error | null
}
```

### Example

```typescript
const { data, error } = await insforge.auth.setProfile({
  name: 'JohnDev',
  bio: 'Full-stack developer',
  avatar_url: 'https://example.com/avatar.jpg',
  custom_field: 'any value', // Any custom fields are supported
});
```

### Output

```json
{
  "data": {
    "id": "usr_abc123",
    "profile": {
      "name": "JohnDev",
      "avatar_url": "https://example.com/avatar.jpg",
      "bio": "Full-stack developer",
      "custom_field": "any value"
    }
  },
  "error": null
}
```

---

## sendResetPasswordEmail()

Send password reset email using the method configured in auth settings (`resetPasswordMethod`). When method is `code`, sends a 6-digit numeric code for two-step flow. When method is `link`, sends a magic link.

<Note>
  This endpoint prevents user enumeration by returning success even if the email doesn't exist.
</Note>

### Parameters

- `email` (string, required) - User's email address

### Returns

```typescript
{
  data: { success: boolean, message: string } | null,
  error: Error | null
}
```

### Example

```javascript
const { data, error } = await insforge.auth.sendResetPasswordEmail({
  email: 'user@example.com',
});

if (data?.success) {
  console.log('Password reset email sent!');
}
```

### Output

```json
{
  "data": {
    "success": true,
    "message": "Password reset email sent"
  },
  "error": null
}
```

---

## exchangeResetPasswordToken()

Exchange a 6-digit reset password code for a reset token. This is step 1 of the two-step password reset flow (only used when `resetPasswordMethod` is `code`).

<Note>
  This endpoint is not used when `resetPasswordMethod` is `link` (magic link flow is direct).
</Note>

### Parameters

- `email` (string, required) - User's email address
- `code` (string, required) - 6-digit code from the email

### Returns

```typescript
{
  data: { token: string, expiresAt: string } | null,
  error: Error | null
}
```

### Example

```javascript
const { data, error } = await insforge.auth.exchangeResetPasswordToken({
  email: 'user@example.com',
  code: '123456',
});

if (data) {
  // Use token to reset password
  await insforge.auth.resetPassword({
    newPassword: 'newSecurePassword123',
    otp: data.token,
  });
}
```

### Output

```json
{
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expiresAt": "2024-01-15T11:00:00Z"
  },
  "error": null
}
```

---

## resetPassword()

Reset user password with a token. The token can be:
- **Magic link token**: 64-character hex token from `sendResetPasswordEmail` when method is `link`
- **Reset token**: From `exchangeResetPasswordToken` after code verification when method is `code`

### Parameters

- `newPassword` (string, required) - New password for the user
- `otp` (string, required) - Reset token or magic link token

### Returns

```typescript
{
  data: { message: string, redirectTo?: string } | null,
  error: Error | null
}
```

### Example

```javascript
// Code method flow: after exchangeResetPasswordToken
const { data, error } = await insforge.auth.resetPassword({
  newPassword: 'newSecurePassword123',
  otp: resetToken, // Token from exchangeResetPasswordToken
});

// Link method flow: token from URL params
const { data, error } = await insforge.auth.resetPassword({
  newPassword: 'newSecurePassword123',
  otp: 'a1b2c3d4e5f6...', // 64-character token from magic link URL
});

if (data) {
  console.log('Password reset successful!');
}
```

### Output

```json
{
  "data": {
    "message": "Password reset successfully",
    "redirectTo": "https://app.example.com/login"
  },
  "error": null
}
```

---

## Error Handling

All auth methods return structured errors:

```javascript
const { data, error } = await insforge.auth.signInWithPassword({
  email: 'user@example.com',
  password: 'wrong_password',
});

if (error) {
  console.error(error.statusCode); // 401
  console.error(error.error); // 'INVALID_CREDENTIALS'
  console.error(error.message); // 'Invalid login credentials'
  console.error(error.nextActions); // 'Check email and password'
}
```
